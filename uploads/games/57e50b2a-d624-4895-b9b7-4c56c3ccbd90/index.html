<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Community Fortune Mini Games - Pac-Man</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Oxanium:wght@400;700;900&display=swap" rel="stylesheet">
<style>
/* CS BEGIN SCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
SSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
SSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
SSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS */
/* CSS STARTS */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body {
  width: 100%;
  height: 100%;
  overflow-x: hidden;
  position: fixed;
  overscroll-behavior: none;
}

body {
  font-family: 'Oxanium', 'Orbitron', 'Press Start 2P', cursive, Arial, sans-serif;
  background: #0a0a0f;
  background-image: 
    radial-gradient(circle at 20% 50%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(255, 0, 255, 0.1) 0%, transparent 50%),
    linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #0a0a0f 100%);
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  min-height: 100vh;
  position: relative;
  touch-action: pan-y;
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    repeating-linear-gradient(
      0deg,
      rgba(0, 255, 255, 0.03) 0px,
      transparent 1px,
      transparent 2px,
      rgba(0, 255, 255, 0.03) 3px
    ),
    repeating-linear-gradient(
      90deg,
      rgba(255, 0, 255, 0.03) 0px,
      transparent 1px,
      transparent 2px,
      rgba(255, 0, 255, 0.03) 3px
    );
  pointer-events: none;
  z-index: 1;
}

body > * {
  position: relative;
  z-index: 2;
}

@media (max-width: 768px) {
  body {
    padding: 5px;
    overflow-y: auto;
    height: auto;
    min-height: 100vh;
  }
}

.brand {
  text-align: center;
  margin-bottom: 10px;
  background: linear-gradient(135deg, rgba(0, 255, 255, 0.1) 0%, rgba(255, 0, 255, 0.1) 100%);
  padding: 10px 20px;
  border-radius: 15px;
  border: 2px solid transparent;
  background-clip: padding-box;
  position: relative;
  backdrop-filter: blur(10px);
}

.brand::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 15px;
  padding: 2px;
  background: linear-gradient(135deg, #00ffff, #ff00ff);
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

.brand-title {
  font-family: 'Orbitron', sans-serif;
  background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-size: 1.2em;
  font-weight: 900;
  letter-spacing: 3px;
  text-transform: uppercase;
  filter: drop-shadow(0 0 20px rgba(0, 255, 255, 0.5));
  animation: brand-glow 3s ease-in-out infinite;
}

@keyframes brand-glow {
  0%, 100% {
    filter: drop-shadow(0 0 20px rgba(0, 255, 255, 0.5));
  }
  50% {
    filter: drop-shadow(0 0 30px rgba(255, 0, 255, 0.8));
  }
}

@media (max-width: 768px) {
  .brand {
    padding: 8px 15px;
    margin-bottom: 5px;
  }
  
  .brand-title {
    font-size: 0.7em;
    letter-spacing: 1px;
  }
}

h1 {
  font-family: 'Orbitron', sans-serif;
  background: linear-gradient(135deg, #ffff00 0%, #ffa500 50%, #ff00ff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-size: 3em;
  margin-bottom: 10px;
  font-weight: 900;
  letter-spacing: 6px;
  text-transform: uppercase;
  filter: drop-shadow(0 0 30px rgba(255, 255, 0, 0.6))
          drop-shadow(0 0 60px rgba(255, 0, 255, 0.4));
  animation: title-pulse 2s infinite alternate;
  position: relative;
}

h1::after {
  content: 'PAC-MAN';
  position: absolute;
  left: 0;
  top: 0;
  background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  z-index: -1;
  filter: blur(20px);
  opacity: 0.5;
}

@media (max-width: 768px) {
  h1 {
    font-size: 1.5em;
    letter-spacing: 2px;
    margin-bottom: 5px;
  }
}

@media (min-width: 1024px) {
  h1 {
    font-size: 4em;
    margin-bottom: 20px;
  }
}

@keyframes title-pulse {
  from { 
    filter: drop-shadow(0 0 30px rgba(255, 255, 0, 0.6))
            drop-shadow(0 0 60px rgba(255, 0, 255, 0.4));
    transform: scale(1);
  }
  to { 
    filter: drop-shadow(0 0 50px rgba(255, 255, 0, 0.9))
            drop-shadow(0 0 80px rgba(255, 0, 255, 0.7));
    transform: scale(1.02);
  }
}

.game-info {
  display: flex;
  gap: 20px;
  margin: 10px 0;
  font-size: 0.9em;
  flex-wrap: wrap;
  justify-content: center;
}

@media (max-width: 768px) {
  .game-info {
    gap: 8px;
    margin: 8px 0;
    font-size: 0.7em;
  }
}

@media (min-width: 1024px) {
  .game-info {
    gap: 40px;
    margin: 20px 0;
    font-size: 1.1em;
  }
}

.info-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  background: rgba(0, 255, 255, 0.05);
  padding: 10px 15px;
  border-radius: 12px;
  border: 2px solid rgba(0, 255, 255, 0.3);
  backdrop-filter: blur(10px);
  position: relative;
  transition: all 0.3s ease;
}

@media (min-width: 1024px) {
  .info-item {
    padding: 15px 25px;
    gap: 10px;
  }
}

.info-item::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: 12px;
  background: linear-gradient(135deg, #00ffff, #ff00ff);
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: -1;
}

.info-item:hover {
  border-color: transparent;
  transform: translateY(-3px);
  box-shadow: 0 10px 40px rgba(0, 255, 255, 0.3);
}

.info-item:hover::before {
  opacity: 1;
}

.info-label {
  font-family: 'Orbitron', sans-serif;
  color: #00ffff;
  font-size: 0.7em;
  font-weight: 700;
  letter-spacing: 2px;
  text-transform: uppercase;
  text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}

.info-value {
  font-family: 'Oxanium', sans-serif;
  background: linear-gradient(135deg, #ffff00 0%, #00ffff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-size: 1.5em;
  font-weight: 900;
  filter: drop-shadow(0 0 10px rgba(255, 255, 0, 0.5));
}

.lives {
  display: flex;
  gap: 6px;
}

.life {
  width: 20px;
  height: 20px;
  background: linear-gradient(135deg, #ffff00 0%, #ffa500 100%);
  border-radius: 50%;
  position: relative;
  overflow: hidden;
  box-shadow: 0 0 15px rgba(255, 255, 0, 0.6),
              inset 0 0 10px rgba(255, 200, 0, 0.5);
  animation: life-pulse 1s infinite alternate;
}

@media (min-width: 1024px) {
  .life {
    width: 24px;
    height: 24px;
  }
}

@keyframes life-pulse {
  from { transform: scale(1); }
  to { transform: scale(1.1); }
}

.life::before {
  content: '';
  position: absolute;
  width: 0;
  height: 0;
  border-top: 10px solid transparent;
  border-bottom: 10px solid transparent;
  border-left: 12px solid #0a0a0f;
  right: 2px;
  top: 0;
}

#game-container {
  position: relative;
  margin: 15px 0;
  padding: 15px;
  background: rgba(0, 255, 255, 0.03);
  border-radius: 20px;
  border: 2px solid rgba(0, 255, 255, 0.3);
  backdrop-filter: blur(10px);
  box-shadow: 
    0 0 40px rgba(0, 255, 255, 0.2),
    inset 0 0 40px rgba(0, 255, 255, 0.05);
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
}

@media (max-width: 768px) {
  #game-container {
    margin: 10px 0;
    padding: 10px;
    transform: scale(0.95);
    transform-origin: top center;
  }
}

@media (min-width: 1024px) {
  #game-container {
    margin: 30px 0;
    padding: 30px;
    transform: scale(1.3);
  }
}

#game {
  display: grid;
  grid-template-columns: repeat(19, 24px);
  gap: 0;
  background: #000;
  border: 4px solid transparent;
  background-clip: padding-box;
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  margin: 0 auto;
}

@media (min-width: 1024px) {
  #game {
    grid-template-columns: repeat(19, 28px);
  }
}

#game::before {
  content: '';
  position: absolute;
  inset: -4px;
  border-radius: 12px;
  background: linear-gradient(135deg, #00ffff, #ff00ff);
  z-index: -1;
  animation: border-flow 3s linear infinite;
}

@keyframes border-flow {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(360deg); }
}

#game::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
  pointer-events: none;
  animation: pulse-glow 2s ease-in-out infinite;
}

@keyframes pulse-glow {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

.cell {
  width: 24px;
  height: 24px;
  background: #000;
  position: relative;
}

@media (min-width: 1024px) {
  .cell {
    width: 28px;
    height: 28px;
  }
}

.wall {
  background: linear-gradient(135deg, #0a4a6e 0%, #1a5a7e 50%, #0a3a5e 100%);
  box-shadow: 
    inset 0 0 10px rgba(0, 255, 255, 0.3),
    0 0 5px rgba(0, 255, 255, 0.2);
  position: relative;
}

.wall::before {
  content: '';
  position: absolute;
  inset: 2px;
  background: linear-gradient(135deg, rgba(0, 255, 255, 0.2), transparent);
  border-radius: 2px;
}

.wall.special { 
  background: linear-gradient(135deg, #8a0a8e 0%, #aa2aae 50%, #6a0a6e 100%);
  box-shadow: 
    inset 0 0 10px rgba(255, 0, 255, 0.4),
    0 0 5px rgba(255, 0, 255, 0.3);
}

.wall.bonus { 
  background: linear-gradient(135deg, #0a8e4a 0%, #2aae6a 50%, #0a6e3a 100%);
  box-shadow: 
    inset 0 0 10px rgba(0, 255, 128, 0.4),
    0 0 5px rgba(0, 255, 128, 0.3);
}

.wall.mega { 
  background: linear-gradient(135deg, #8e4a0a 0%, #ae6a2a 50%, #6e3a0a 100%);
  box-shadow: 
    inset 0 0 10px rgba(255, 128, 0, 0.4),
    0 0 5px rgba(255, 128, 0, 0.3);
  animation: mega-pulse 0.5s infinite alternate;
}

@keyframes mega-pulse {
  from { filter: brightness(1); }
  to { filter: brightness(1.3); }
}

.dot::after {
  content: '';
  width: 5px;
  height: 5px;
  background: #00ffff;
  border-radius: 50%;
  position: absolute;
  top: 9px;
  left: 9px;
  box-shadow: 
    0 0 8px rgba(0, 255, 255, 0.8),
    0 0 15px rgba(0, 255, 255, 0.4);
  animation: dot-twinkle 2s infinite alternate;
}

@media (min-width: 1024px) {
  .dot::after {
    width: 6px;
    height: 6px;
    top: 11px;
    left: 11px;
  }
}

@keyframes dot-twinkle {
  from { opacity: 0.6; }
  to { opacity: 1; }
}

.power-pellet::after {
  content: '';
  width: 12px;
  height: 12px;
  background: radial-gradient(circle, #ffff00 0%, #ff00ff 100%);
  border-radius: 50%;
  position: absolute;
  top: 6px;
  left: 6px;
  animation: power-pulse 0.4s infinite alternate;
  box-shadow: 
    0 0 15px rgba(255, 255, 0, 0.8),
    0 0 25px rgba(255, 0, 255, 0.6),
    inset 0 0 8px rgba(255, 255, 255, 0.5);
}

@media (min-width: 1024px) {
  .power-pellet::after {
    width: 14px;
    height: 14px;
    top: 7px;
    left: 7px;
  }
}

@keyframes power-pulse {
  from { 
    transform: scale(1); 
    opacity: 1;
    filter: brightness(1);
  }
  to { 
    transform: scale(1.3); 
    opacity: 0.7;
    filter: brightness(1.5);
  }
}

.fruit::after {
  content: 'üçí';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: fruit-float 1s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 0, 255, 0.6));
}

@media (min-width: 1024px) {
  .fruit::after {
    font-size: 20px;
    top: 3px;
    left: 3px;
  }
}

@keyframes fruit-float {
  0%, 100% { 
    transform: translateY(0) scale(1); 
  }
  50% { 
    transform: translateY(-4px) scale(1.1); 
  }
}

.pacman {
  width: 24px;
  height: 24px;
  background: radial-gradient(circle, #ffff00 0%, #ffaa00 100%);
  border-radius: 50%;
  position: relative;
  z-index: 10;
  box-shadow: 
    0 0 20px rgba(255, 255, 0, 0.8),
    0 0 35px rgba(255, 170, 0, 0.5),
    inset 0 0 10px rgba(255, 255, 255, 0.3);
  overflow: visible;
  animation: pacman-glow 0.5s ease-in-out infinite alternate;
}

@media (min-width: 1024px) {
  .pacman {
    width: 28px;
    height: 28px;
  }
}

@keyframes pacman-glow {
  from {
    box-shadow: 
      0 0 20px rgba(255, 255, 0, 0.8),
      0 0 35px rgba(255, 170, 0, 0.5),
      inset 0 0 10px rgba(255, 255, 255, 0.3);
  }
  to {
    box-shadow: 
      0 0 30px rgba(255, 255, 0, 1),
      0 0 50px rgba(255, 170, 0, 0.8),
      inset 0 0 15px rgba(255, 255, 255, 0.5);
  }
}

.pacman.super {
  background: radial-gradient(circle, #00ffff 0%, #ff00ff 100%);
  box-shadow: 
    0 0 30px rgba(0, 255, 255, 1),
    0 0 50px rgba(255, 0, 255, 0.8),
    inset 0 0 15px rgba(255, 255, 255, 0.5);
  animation: super-glow 0.2s infinite;
}

@keyframes super-glow {
  0%, 100% { 
    transform: scale(1);
    filter: brightness(1.2);
  }
  50% { 
    transform: scale(1.15);
    filter: brightness(1.5);
  }
}

.pacman::before {
  content: '';
  position: absolute;
  width: 6px;
  height: 6px;
  background: #000;
  border-radius: 50%;
  top: 5px;
  left: 15px;
  z-index: 3;
  box-shadow: 0 0 3px rgba(0, 255, 255, 0.5);
}

@media (min-width: 1024px) {
  .pacman::before {
    width: 7px;
    height: 7px;
    top: 6px;
    left: 18px;
  }
}

.pacman::after {
  content: '';
  position: absolute;
  width: 0;
  height: 0;
  top: 50%;
  left: 50%;
  transform-origin: left center;
  border-left: 16px solid #0a0a0f;
  border-top: 12px solid transparent;
  border-bottom: 12px solid transparent;
  z-index: 2;
  animation: constant-chomp 0.3s infinite;
}

@media (min-width: 1024px) {
  .pacman::after {
    border-left: 19px solid #0a0a0f;
    border-top: 14px solid transparent;
    border-bottom: 14px solid transparent;
  }
}

.pacman.right::after {
  top: 50%;
  left: 50%;
  transform: translate(0, -50%);
  border-left: 16px solid #0a0a0f;
  border-top: 12px solid transparent;
  border-bottom: 12px solid transparent;
  border-right: none;
}

@media (min-width: 1024px) {
  .pacman.right::after {
    border-left: 19px solid #0a0a0f;
    border-top: 14px solid transparent;
    border-bottom: 14px solid transparent;
  }
}

.pacman.left {
  transform: scaleX(-1);
}

.pacman.up {
  transform: rotate(-90deg);
}

.pacman.down {
  transform: rotate(90deg);
}

@keyframes constant-chomp {
  0% { 
    border-left-width: 16px;
    border-top-width: 12px;
    border-bottom-width: 12px;
  }
  25% {
    border-left-width: 8px;
    border-top-width: 6px;
    border-bottom-width: 6px;
  }
  50% { 
    border-left-width: 0px;
    border-top-width: 0px;
    border-bottom-width: 0px;
  }
  75% {
    border-left-width: 8px;
    border-top-width: 6px;
    border-bottom-width: 6px;
  }
  100% { 
    border-left-width: 16px;
    border-top-width: 12px;
    border-bottom-width: 12px;
  }
}

.pacman.eating::after {
  animation: constant-chomp 0.15s infinite;
}

.ghost {
  background: linear-gradient(to bottom, currentColor 65%, transparent 65%);
  border-radius: 50% 50% 0 0;
  position: relative;
  z-index: 9;
  animation: ghost-float 0.5s infinite alternate;
  filter: drop-shadow(0 0 10px currentColor);
}

@keyframes ghost-float {
  from { transform: translateY(0); }
  to { transform: translateY(-3px); }
}

.ghost::before {
  content: '';
  position: absolute;
  width: 7px;
  height: 7px;
  background: #fff;
  border-radius: 50%;
  top: 6px;
  left: 4px;
  box-shadow: 
    10px 0 0 #fff,
    0 0 5px rgba(255, 255, 255, 0.5),
    10px 0 5px rgba(255, 255, 255, 0.5);
}

.ghost::after {
  content: '';
  position: absolute;
  width: 3px;
  height: 3px;
  background: #000;
  border-radius: 50%;
  top: 8px;
  left: 6px;
  box-shadow: 
    10px 0 0 #000,
    0 9px 0 3px currentColor,
    4px 9px 0 3px currentColor,
    8px 9px 0 3px currentColor,
    12px 9px 0 3px currentColor,
    16px 9px 0 3px currentColor;
}

.ghost.red { 
  color: #ff0055;
  filter: drop-shadow(0 0 15px #ff0055);
}
.ghost.pink { 
  color: #ffb8ff;
  filter: drop-shadow(0 0 15px #ffb8ff);
}
.ghost.cyan { 
  color: #00ffff;
  filter: drop-shadow(0 0 15px #00ffff);
}
.ghost.orange { 
  color: #ffaa00;
  filter: drop-shadow(0 0 15px #ffaa00);
}
.ghost.purple { 
  color: #ff00ff;
  filter: drop-shadow(0 0 15px #ff00ff);
}
.ghost.green { 
  color: #00ff88;
  filter: drop-shadow(0 0 15px #00ff88);
}

.ghost.scared {
  color: #0066ff !important;
  animation: scared-flash 0.15s infinite;
  filter: drop-shadow(0 0 20px #0066ff);
}

@keyframes scared-flash {
  0%, 50% { 
    color: #0066ff !important;
    filter: drop-shadow(0 0 20px #0066ff);
  }
  51%, 100% { 
    color: #ffffff !important;
    filter: drop-shadow(0 0 20px #ffffff);
  }
}

.ghost.eaten {
  background: transparent !important;
  border: 3px solid #00ffff;
  animation: eaten-spin 1s linear infinite;
  filter: drop-shadow(0 0 15px #00ffff);
}

@keyframes eaten-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

#game-instructions {
  font-family: 'Oxanium', sans-serif;
  background: rgba(0, 255, 255, 0.05);
  border: 2px solid rgba(0, 255, 255, 0.3);
  padding: 15px 20px;
  margin: 10px auto;
  max-width: 700px;
  border-radius: 15px;
  font-size: 0.75em;
  line-height: 1.6;
  backdrop-filter: blur(10px);
  box-shadow: 
    0 0 30px rgba(0, 255, 255, 0.2),
    inset 0 0 30px rgba(0, 255, 255, 0.05);
  position: relative;
}

#game-instructions::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(135deg, #00ffff, #ff00ff);
  border-radius: 15px;
  z-index: -1;
  opacity: 0.5;
  filter: blur(10px);
}

@media (max-width: 768px) {
  #game-instructions {
    font-size: 0.65em;
    padding: 12px 15px;
    max-width: 95%;
    line-height: 1.5;
    margin: 8px auto;
  }
}

@media (min-width: 1024px) {
  #game-instructions {
    font-size: 0.9em;
    padding: 20px 30px;
    line-height: 1.8;
    margin: 20px auto;
  }
}

#game-instructions h3 {
  font-family: 'Orbitron', sans-serif;
  background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 12px;
  font-size: 1.2em;
  font-weight: 900;
  letter-spacing: 2px;
  text-transform: uppercase;
}

#game-instructions ul {
  list-style: none;
  padding: 0;
}

#game-instructions li {
  margin: 8px 0;
  padding-left: 25px;
  position: relative;
  color: rgba(255, 255, 255, 0.9);
}

#game-instructions li::before {
  content: '‚ñ∏';
  position: absolute;
  left: 0;
  color: #00ffff;
  font-size: 1.2em;
  text-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
}

#game-instructions strong {
  color: #00ffff;
  text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}

.message {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(10, 10, 15, 0.98);
  padding: 30px 40px;
  border: 3px solid transparent;
  background-clip: padding-box;
  border-radius: 20px;
  text-align: center;
  z-index: 1000;
  max-width: 90%;
max-height: 80vh;
overflow-y: auto;
backdrop-filter: blur(20px);
box-shadow:
0 0 60px rgba(0, 255, 255, 0.4),
inset 0 0 40px rgba(0, 255, 255, 0.1);
animation: message-appear 0.3s ease-out;
}
@keyframes message-appear {
from {
opacity: 0;
transform: translate(-50%, -50%) scale(0.8);
}
to {
opacity: 1;
transform: translate(-50%, -50%) scale(1);
}
}
.message::before {
content: '';
position: absolute;
inset: -3px;
border-radius: 20px;
background: linear-gradient(135deg, #00ffff, #ff00ff);
z-index: -1;
animation: border-flow 3s linear infinite;
}
@media (max-width: 768px) {
.message {
padding: 25px 30px;
max-width: 85%;
}
}
@media (min-width: 1024px) {
.message {
padding: 40px 60px;
}
}
.message h2 {
font-family: 'Orbitron', sans-serif;
background: linear-gradient(135deg, #ffff00 0%, #00ffff 50%, #ff00ff 100%);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
margin-bottom: 15px;
font-size: 1.8em;
font-weight: 900;
letter-spacing: 3px;
text-transform: uppercase;
filter: drop-shadow(0 0 20px rgba(0, 255, 255, 0.6));
}
@media (max-width: 768px) {
.message h2 {
font-size: 1.3em;
letter-spacing: 2px;
}
}
@media (min-width: 1024px) {
.message h2 {
font-size: 2.2em;
}
}
.message p {
font-family: 'Oxanium', sans-serif;
margin: 12px 0;
font-size: 1em;
color: rgba(255, 255, 255, 0.9);
}
@media (max-width: 768px) {
.message p {
font-size: 0.85em;
margin: 10px 0;
}
}
@media (min-width: 1024px) {
.message p {
font-size: 1.1em;
margin: 15px 0;
}
}
.message button {
font-family: 'Orbitron', sans-serif;
margin-top: 20px;
padding: 12px 35px;
font-size: 1em;
font-weight: 700;
background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
color: #fff;
border: none;
border-radius: 12px;
cursor: pointer;
transition: all 0.3s ease;
box-shadow: 0 6px 0 rgba(0, 100, 150, 0.5);
text-transform: uppercase;
letter-spacing: 2px;
position: relative;
overflow: hidden;
}
@media (min-width: 1024px) {
.message button {
padding: 15px 45px;
font-size: 1.2em;
}
}
.message button::before {
content: '';
position: absolute;
inset: 0;
background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
opacity: 0;
transition: opacity 0.3s ease;
}
.message button:hover {
transform: translateY(-3px);
box-shadow:
0 9px 0 rgba(0, 100, 150, 0.5),
0 0 30px rgba(0, 255, 255, 0.6);
}
.message button:hover::before {
opacity: 1;
}
.message button:active {
transform: translateY(3px);
box-shadow: 0 3px 0 rgba(0, 100, 150, 0.5);
}
.controls {
font-family: 'Oxanium', sans-serif;
margin-top: 15px;
font-size: 0.75em;
color: rgba(0, 255, 255, 0.7);
text-align: center;
text-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
letter-spacing: 1px;
}
@media (max-width: 768px) {
.controls {
font-size: 0.65em;
margin-top: 10px;
}
}
@media (min-width: 1024px) {
.controls {
font-size: 0.9em;
margin-top: 20px;
}
}
.button-controls {
display: flex;
flex-direction: column;
align-items: center;
gap: 10px;
margin-top: 15px;
touch-action: manipulation;
user-select: none;
-webkit-user-select: none;
}
@media (max-width: 768px) {
.button-controls {
gap: 12px;
margin-top: 15px;
position: sticky;
bottom: 10px;
background: rgba(10, 10, 15, 0.9);
padding: 15px;
border-radius: 20px;
border: 2px solid rgba(0, 255, 255, 0.3);
}
}
@media (min-width: 1024px) {
.button-controls {
gap: 15px;
margin-top: 30px;
}
}
.button-row {
display: flex;
gap: 10px;
}
@media (max-width: 768px) {
.button-row {
gap: 12px;
}
}
@media (min-width: 1024px) {
.button-row {
gap: 15px;
}
}
.control-btn {
width: 65px;
height: 65px;
background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
border: 3px solid rgba(255, 255, 255, 0.3);
border-radius: 15px;
font-size: 1.8em;
color: #fff;
cursor: pointer;
user-select: none;
-webkit-user-select: none;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.2s ease;
font-family: Arial, sans-serif;
box-shadow:
0 6px 0 rgba(0, 100, 150, 0.5),
0 0 20px rgba(0, 255, 255, 0.4);
touch-action: manipulation;
position: relative;
overflow: hidden;
}
@media (max-width: 768px) {
.control-btn {
width: 75px;
height: 75px;
font-size: 2em;
}
}
@media (min-width: 1024px) {
.control-btn {
width: 80px;
height: 80px;
font-size: 2.2em;
}
}
.control-btn::before {
content: '';
position: absolute;
inset: 0;
background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
opacity: 0;
transition: opacity 0.2s ease;
}
.control-btn:hover {
transform: translateY(-3px);
box-shadow:
0 9px 0 rgba(0, 100, 150, 0.5),
0 0 30px rgba(0, 255, 255, 0.6);
}
.control-btn:hover::before {
opacity: 1;
}
.control-btn:active {
transform: translateY(3px);
box-shadow:
0 3px 0 rgba(0, 100, 150, 0.5),
0 0 20px rgba(0, 255, 255, 0.4);
}
#ready-text {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
font-family: 'Orbitron', sans-serif;
background: linear-gradient(135deg, #ffff00 0%, #00ffff 100%);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
font-size: 2em;
font-weight: 900;
letter-spacing: 3px;
text-transform: uppercase;
filter: drop-shadow(0 0 30px rgba(255, 255, 0, 0.8));
z-index: 50;
animation: ready-blink 0.5s infinite;
}
@media (max-width: 768px) {
#ready-text {
font-size: 1.5em;
}
}
@media (min-width: 1024px) {
#ready-text {
font-size: 2.8em;
}
}
@keyframes ready-blink {
0%, 50% { opacity: 1; }
51%, 100% { opacity: 0; }
}
.special-feature {
font-family: 'Oxanium', sans-serif;
background: rgba(255, 0, 255, 0.1);
border: 2px solid #ff00ff;
padding: 12px 20px;
margin: 10px auto;
max-width: 600px;
border-radius: 12px;
font-size: 0.8em;
text-align: center;
background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
font-weight: 900;
letter-spacing: 2px;
text-transform: uppercase;
backdrop-filter: blur(10px);
box-shadow:
0 0 30px rgba(255, 0, 255, 0.4),
inset 0 0 30px rgba(255, 0, 255, 0.1);
animation: feature-glow 1s infinite alternate;
position: relative;
}
@keyframes feature-glow {
from {
box-shadow:
0 0 30px rgba(255, 0, 255, 0.4),
inset 0 0 30px rgba(255, 0, 255, 0.1);
}
to {
box-shadow:
0 0 50px rgba(255, 0, 255, 0.7),
inset 0 0 40px rgba(255, 0, 255, 0.2);
}
}
@media (max-width: 768px) {
.special-feature {
font-size: 0.65em;
padding: 10px 15px;
margin: 8px auto;
}
}
@media (min-width: 1024px) {
.special-feature {
font-size: 1em;
padding: 15px 30px;
margin: 15px auto;
}
}
.sound-toggle {
position: fixed;
top: 20px;
right: 20px;
background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
border: 3px solid rgba(255, 255, 255, 0.3);
border-radius: 50%;
width: 55px;
height: 55px;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
font-size: 1.6em;
transition: all 0.3s ease;
z-index: 1000;
box-shadow:
0 6px 0 rgba(0, 100, 150, 0.5),
0 0 25px rgba(0, 255, 255, 0.4);
touch-action: manipulation;
}
@media (max-width: 768px) {
.sound-toggle {
top: 10px;
right: 10px;
width: 50px;
height: 50px;
font-size: 1.4em;
}
}
@media (min-width: 1024px) {
.sound-toggle {
width: 65px;
height: 65px;
font-size: 1.8em;
}
}
.sound-toggle:hover {
transform: scale(1.15) rotate(15deg);
box-shadow:
0 8px 0 rgba(0, 100, 150, 0.5),
0 0 40px rgba(0, 255, 255, 0.7);
}
.sound-toggle:active {
transform: translateY(3px) scale(1.1);
box-shadow:
0 3px 0 rgba(0, 100, 150, 0.5),
0 0 25px rgba(0, 255, 255, 0.4);
}
/* Snowfall effect */
.snowflake {
position: fixed;
top: -10px;
z-index: 1;
user-select: none;
cursor: default;
animation-name: snowfall;
animation-duration: 10s;
animation-timing-function: linear;
animation-iteration-count: infinite;
color: rgba(255, 255, 255, 0.8);
font-size: 1em;
pointer-events: none;
}
@keyframes snowfall {
0% {
transform: translateY(0vh) rotate(0deg);
opacity: 1;
}
100% {
transform: translateY(100vh) rotate(360deg);
opacity: 0.3;
}
}
.snowflake:nth-of-type(0) { left: 1%; animation-delay: 0s; animation-duration: 10s; }
.snowflake:nth-of-type(1) { left: 10%; animation-delay: 1s; animation-duration: 12s; }
.snowflake:nth-of-type(2) { left: 20%; animation-delay: 6s; animation-duration: 9s; }
.snowflake:nth-of-type(3) { left: 30%; animation-delay: 4s; animation-duration: 11s; }
.snowflake:nth-of-type(4) { left: 40%; animation-delay: 2s; animation-duration: 10s; }
.snowflake:nth-of-type(5) { left: 50%; animation-delay: 8s; animation-duration: 13s; }
.snowflake:nth-of-type(6) { left: 60%; animation-delay: 5s; animation-duration: 10s; }
.snowflake:nth-of-type(7) { left: 70%; animation-delay: 3s; animation-duration: 11s; }
.snowflake:nth-of-type(8) { left: 80%; animation-delay: 7s; animation-duration: 9s; }
.snowflake:nth-of-type(9) { left: 90%; animation-delay: 9s; animation-duration: 12s; }
.extra-life::after {
  content: '‚ù§Ô∏è';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: heartbeat 0.6s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 0, 100, 0.8));
}

@keyframes heartbeat {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.3); }
}

.shield::after {
  content: 'üõ°Ô∏è';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: shield-rotate 2s linear infinite;
  filter: drop-shadow(0 0 10px rgba(100, 200, 255, 0.8));
}

@keyframes shield-rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.freeze::after {
  content: '‚ùÑÔ∏è';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: freeze-pulse 0.8s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(150, 220, 255, 0.8));
}

@keyframes freeze-pulse {
  0%, 100% { transform: scale(1) rotate(0deg); }
  50% { transform: scale(1.2) rotate(10deg); }
}

.speed-boost::after {
  content: '‚ö°';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: lightning-flash 0.3s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 255, 0, 0.9));
}

@keyframes lightning-flash {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.3); }
}

.ghost-repel::after {
  content: 'üåü';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: star-twinkle 0.5s ease-in-out infinite alternate;
  filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.9));
}

@keyframes star-twinkle {
  from { transform: rotate(0deg) scale(1); }
  to { transform: rotate(180deg) scale(1.2); }
}

.double-points::after {
  content: 'üí∞';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: money-bounce 0.6s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
}

@keyframes money-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.confusion::after {
  content: 'üåÄ';
position: absolute;
top: 2px;
left: 2px;
font-size: 16px;
animation: confusion-spin 1s linear infinite;
filter: drop-shadow(0 0 10px rgba(138, 43, 226, 0.8));
}
@keyframes confusion-spin {
from { transform: rotate(0deg); }
to { transform: rotate(360deg); }
}
.extra-life::after {
  content: '‚ù§Ô∏è';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: heartbeat 0.6s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 0, 100, 0.8));
}

@keyframes heartbeat {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.3); }
}

.shield::after {
  content: 'üõ°Ô∏è';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: shield-rotate 2s linear infinite;
  filter: drop-shadow(0 0 10px rgba(100, 200, 255, 0.8));
}

@keyframes shield-rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.freeze::after {
  content: '‚ùÑÔ∏è';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: freeze-pulse 0.8s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(150, 220, 255, 0.8));
}

@keyframes freeze-pulse {
  0%, 100% { transform: scale(1) rotate(0deg); }
  50% { transform: scale(1.2) rotate(10deg); }
}

.speed-boost::after {
  content: '‚ö°';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: lightning-flash 0.3s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 255, 0, 0.9));
}

@keyframes lightning-flash {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.3); }
}

.ghost-repel::after {
  content: 'üåü';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: star-twinkle 0.5s ease-in-out infinite alternate;
  filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.9));
}

@keyframes star-twinkle {
  from { transform: rotate(0deg) scale(1); }
  to { transform: rotate(180deg) scale(1.2); }
}

.double-points::after {
  content: 'üí∞';
  position: absolute;
  top: 2px;
  left: 2px;
  font-size: 16px;
  animation: money-bounce 0.6s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
}

@keyframes money-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
.boss-ghost {
width: 48px !important;
height: 48px !important;
background: linear-gradient(to bottom, #ff0000 65%, transparent 65%) !important;
border-radius: 50% 50% 0 0;
position: relative;
z-index: 20;
animation: boss-float 0.3s infinite alternate;
filter: drop-shadow(0 0 20px #ff0000) drop-shadow(0 0 40px #ff4500);
transform: scale(2);
}
.boss-message {
position: fixed;
top: 20%;
left: 50%;
transform: translateX(-50%);
background: rgba(255, 0, 0, 0.9);
color: #fff;
padding: 15px 30px;
border-radius: 15px;
font-family: 'Orbitron', sans-serif;
font-size: 1.2em;
font-weight: bold;
z-index: 1000;
animation: boss-message-appear 0.5s ease-out;
box-shadow: 0 0 30px rgba(255, 0, 0, 0.8);
}
@keyframes boss-message-appear {
from {
opacity: 0;
transform: translateX(-50%) translateY(-20px);
}
to {
opacity: 1;
transform: translateX(-50%) translateY(0);
}
}
.boss-healthbar {
position: fixed;
top: 10%;
left: 50%;
transform: translateX(-50%);
width: 400px;
height: 30px;
background: rgba(0, 0, 0, 0.8);
border: 3px solid #ff0000;
border-radius: 15px;
padding: 3px;
z-index: 1000;
}
.boss-healthbar-fill {
height: 100%;
background: linear-gradient(90deg, #ff0000, #ff4500, #ffa500);
border-radius: 10px;
transition: width 0.3s ease;
animation: health-pulse 1s ease-in-out infinite;
}
@keyframes health-pulse {
0%, 100% { filter: brightness(1); }
50% { filter: brightness(1.3); }
}
/* CSS ENDS CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS
CSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSSCSS */
</style>

</head>
<body>
<!-- Snowflakes -->
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>
<div class="snowflake">‚ùÑ</div>

<div class="brand">
  <div class="brand-title">COMMUNITY FORTUNE MINI GAMES</div>
</div>
<h1>PAC-MAN</h1>
<div class="sound-toggle" id="sound-toggle" onclick="toggleSound()" title="Toggle Sound">
  üîä
</div>
<div id="game-instructions">
  <h3>HOW TO PLAY:</h3>
  <ul>
    <li><strong>YOU are Pac-Man</strong> - Eat all dots to advance!</li>
    <li><strong>Avoid ghosts</strong> unless they're blue</li>
    <li><strong>Every 10 levels</strong> unlocks special features!</li>
    <li><strong>Each level has a unique map</strong> - 30 epic challenges!</li>
  </ul>
</div>
<div id="special-feature" class="special-feature" style="display:none;" data-text=""></div>
<div class="game-info">
  <div class="info-item">
    <span class="info-label">SCORE</span>
    <span class="info-value" id="score">0</span>
  </div>
  <div class="info-item">
    <span class="info-label">LEVEL</span>
    <span class="info-value" id="level">1</span>
  </div>
  <div class="info-item">
    <span class="info-label">LIVES</span>
    <div class="lives" id="lives"></div>
  </div>
  <div class="info-item">
    <span class="info-label">HIGH SCORE</span>
    <span class="info-value" id="highscore">0</span>
  </div>
</div>
<div id="game-container">
  <div id="game"></div>
</div>
<div class="controls">
  Use Arrow Keys or WASD to move ‚Ä¢ Swipe on mobile ‚Ä¢ Eat all dots to advance!
</div>
<div class="button-controls">
  <div class="button-row">
    <div class="control-btn" id="btn-up">‚ñ≤</div>
  </div>
  <div class="button-row">
    <div class="control-btn" id="btn-left">‚óÑ</div>
    <div class="control-btn" id="btn-down">‚ñº</div>
    <div class="control-btn" id="btn-right">‚ñ∫</div>
  </div>
</div>
<script>
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// Audio Context for sound effects
// JS STARTS - PACMAN GAME
// Audio Context for sound effects
const audioContext = new (window.AudioContext || window.webkitAudioContext)();
let soundEnabled = true;

// DEV MODE - Uncomment the line below to enable developer mode
const DEV_MODE = true;
//const DEV_MODE = false;

function playSound(type) {
  if (!soundEnabled) return;
  
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  const now = audioContext.currentTime;
  
  switch(type) {
    case 'chomp':
      oscillator.frequency.setValueAtTime(400, now);
      oscillator.frequency.exponentialRampToValueAtTime(200, now + 0.05);
      gainNode.gain.setValueAtTime(0.3, now);
      gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
      oscillator.start(now);
      oscillator.stop(now + 0.05);
      break;
      
    case 'eatGhost':
      oscillator.frequency.setValueAtTime(200, now);
      oscillator.frequency.exponentialRampToValueAtTime(800, now + 0.2);
      gainNode.gain.setValueAtTime(0.4, now);
      gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
      oscillator.start(now);
      oscillator.stop(now + 0.2);
      break;
      
    case 'powerPellet':
      oscillator.frequency.setValueAtTime(800, now);
      oscillator.frequency.exponentialRampToValueAtTime(200, now + 0.3);
      oscillator.type = 'square';
      gainNode.gain.setValueAtTime(0.3, now);
      gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
      oscillator.start(now);
      oscillator.stop(now + 0.3);
      break;
      
    case 'death':
      oscillator.frequency.setValueAtTime(800, now);
      oscillator.frequency.exponentialRampToValueAtTime(100, now + 0.5);
      oscillator.type = 'sawtooth';
      gainNode.gain.setValueAtTime(0.5, now);
      gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
      oscillator.start(now);
      oscillator.stop(now + 0.5);
      break;
      
    case 'levelComplete':
      for(let i = 0; i < 5; i++) {
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        osc.connect(gain);
        gain.connect(audioContext.destination);
        osc.frequency.setValueAtTime(400 + (i * 100), now + (i * 0.1));
        gain.gain.setValueAtTime(0.2, now + (i * 0.1));
        gain.gain.exponentialRampToValueAtTime(0.01, now + (i * 0.1) + 0.1);
        osc.start(now + (i * 0.1));
        osc.stop(now + (i * 0.1) + 0.1);
      }
      break;
      
    case 'fruit':
      oscillator.frequency.setValueAtTime(600, now);
      oscillator.frequency.setValueAtTime(800, now + 0.05);
      oscillator.frequency.setValueAtTime(1000, now + 0.1);
      oscillator.type = 'sine';
      gainNode.gain.setValueAtTime(0.3, now);
      gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
      oscillator.start(now);
      oscillator.stop(now + 0.15);
      break;
  }
}

function toggleSound() {
  soundEnabled = !soundEnabled;
  document.getElementById('sound-toggle').textContent = soundEnabled ? 'üîä' : 'üîá';
}

const gameEl = document.getElementById('game');
const scoreEl = document.getElementById('score');
const levelEl = document.getElementById('level');
const livesEl = document.getElementById('lives');
const highscoreEl = document.getElementById('highscore');
const gameContainer = document.getElementById('game-container');
const specialFeatureEl = document.getElementById('special-feature');

const GRID_WIDTH = 19;
const GRID_HEIGHT = 21;

// Power-up types
const POWER_UPS = {
  EXTRA_LIFE: 5,
  SHIELD: 6,
  FREEZE: 7,
  SPEED_BOOST: 8,
  GHOST_REPEL: 9,
  DOUBLE_POINTS: 10,
  CONFUSION: 11
};

let score = 0;
let level = 1;
let lives = 3;
let highscore = parseInt(localStorage.getItem('pacman-highscore')) || 0;
let gameActive = false;
let powerMode = false;
let superMode = false;
let powerModeTimer = null;
let fruitPresent = false;
let shieldActive = false;
let freezeActive = false;
let speedBoostActive = false;
let doublePointsActive = false;
let confusionActive = false;
let bossDefeated = false;
let bossHealth = 100;
let bossPhase = 1;
let bossMessages = [];
let powerUpSpawnInterval;

const mapTemplates = [
  // Map 1 - Classic
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,2,1,
    1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1,
    1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1,
    1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,
    1,1,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,1,1,
    1,1,1,1,0,1,0,0,0,0,0,0,0,1,0,1,1,1,1,
    1,1,1,1,0,1,0,1,1,3,1,1,0,1,0,1,1,1,1,
    0,0,0,0,0,0,0,1,3,3,3,1,0,0,0,0,0,0,0,
    1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,
    1,1,1,1,0,1,0,0,0,0,0,0,0,1,0,1,1,1,1,
    1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,
    1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
    1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1,
    1,2,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,2,1,
    1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,1,1,
    1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],
  // Map 2 - Symmetrical
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,
    1,0,1,0,1,1,0,1,0,0,0,1,0,1,1,0,1,0,1,
    1,0,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,0,3,0,1,1,1,1,1,1,1,1,
    1,2,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,2,1,
    1,1,1,1,1,1,1,1,0,3,0,1,1,1,1,1,1,1,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,0,1,
    1,0,1,0,1,1,0,1,0,0,0,1,0,1,1,0,1,0,1,
    1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],
  // Map 3 - Fixed Spiral (was impossible) - NOW BEATABLE
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,
    1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,2,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,2,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],
  // Map 4 - Cross Pattern
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,1,
    1,2,0,0,1,0,1,0,3,3,3,0,1,0,1,0,0,2,1,
    1,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],
  // Map 5 - Long Corridor Chase
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 6 - Ghost House Traps
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,2,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,2,1,
  1,0,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,0,1,
  1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
  1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,
  1,0,0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,0,1,
  1,1,1,1,0,1,1,1,1,3,1,1,1,1,0,1,1,1,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
  1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
  1,0,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,0,1,
  1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,
  1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 7 - Zigzag Lightning
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,
  1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,
  1,2,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,2,1,
  1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,1,
  1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,
  1,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,
  1,0,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,0,1,
  1,1,0,1,0,0,1,0,0,3,0,0,0,1,0,0,1,0,1,
  1,0,0,0,0,1,0,0,1,3,0,1,0,0,0,1,0,0,1,
  1,0,1,0,1,0,0,1,0,3,0,0,0,1,0,0,0,1,1,
  1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,1,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,1,
  1,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,1,
  1,0,1,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,1,
  1,2,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,2,1,
  1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,1,
  1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 8 - Mirror Maze
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,2,1,
  1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
  1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,
  1,0,1,0,1,1,0,1,0,1,0,1,0,1,1,0,1,0,1,
  1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,
  1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
  1,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,1,
  1,0,0,0,1,1,1,1,0,1,0,1,1,1,1,0,0,0,1,
  1,2,1,1,1,0,0,0,0,3,0,0,0,0,1,1,1,2,1,
  1,0,0,0,1,1,1,1,0,3,0,1,1,1,1,0,0,0,1,
  1,0,1,0,1,0,0,0,0,3,0,0,0,0,1,0,1,0,1,
  1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
  1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,
  1,0,1,0,1,1,0,1,0,1,0,1,0,1,1,0,1,0,1,
  1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,
  1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
  1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 9 - 5-Ghost Frenzy (Branching Tree)
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
  1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
  1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
  1,1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,0,1,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,1,0,1,1,1,1,1,0,3,0,1,1,1,1,1,0,1,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
  1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
  1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 10 - Fruit Feast Ring
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,
  1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
  1,0,1,0,0,1,1,1,1,1,1,1,1,1,0,0,1,0,1,
  1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
  1,0,1,0,1,0,0,1,1,1,1,1,0,0,1,0,1,0,1,
  1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
  1,0,1,0,1,0,1,0,0,2,0,0,1,0,1,0,1,0,1,
  1,0,0,0,0,0,1,0,2,3,2,0,1,0,0,0,0,0,1,
  1,0,1,0,1,0,1,0,0,2,0,0,1,0,1,0,1,0,1,
  1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
  1,0,1,0,1,0,0,1,1,1,1,1,0,0,1,0,1,0,1,
  1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
  1,0,1,0,0,1,1,1,1,1,1,1,1,1,0,0,1,0,1,
  1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
  1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 11 - Elevator Shafts
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,2,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,1,
  1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,1,
  1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,
  1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1,
  1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,
  1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,
  1,0,0,0,0,1,0,0,0,3,0,0,0,1,0,0,0,0,1,
  1,0,1,1,0,1,0,1,1,3,1,1,0,1,0,1,1,0,1,
  1,0,0,0,0,1,0,0,0,3,0,0,0,1,0,0,0,0,1,
  1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,
  1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,
  1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,
  1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,
  1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,1,
  1,2,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 12 - The Labyrinth (Level 12)
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,0,0,1,0,0,0,1,2,1,0,0,0,1,0,0,0,1,
  1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,
  1,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,
  1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,
  1,0,0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,0,1,
  1,0,1,1,1,0,1,1,1,3,1,1,1,0,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,
  1,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,
  1,0,1,0,1,0,1,0,1,2,1,0,1,0,1,0,1,0,1,
  1,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 13 - Diamond Mine (FIXED - No traps)
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,
    1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,2,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0,2,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],

// Map 14 - Checkered Chaos (Level 14)
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,1,0,1,0,1,0,1,2,1,0,1,0,1,0,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,1,0,1,0,1,0,1,1,3,1,1,0,1,0,1,0,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,0,1,0,1,0,1,2,1,0,1,0,1,0,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 15 - Spiral Galaxy (FIXED - No traps)
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,
    1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,1,
    1,0,1,0,1,0,1,0,0,0,0,0,0,1,0,1,0,0,1,
    1,0,1,0,1,0,1,0,1,1,1,1,0,1,0,1,1,0,1,
    1,0,1,0,1,0,1,0,1,3,3,1,0,1,0,0,0,0,1,
    1,0,1,0,1,0,1,0,1,3,0,1,0,1,0,1,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,0,1,0,1,0,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,2,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,2,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],

// Map 16 - Cross Roads (Level 16)
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,2,1,
  1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
  1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
  1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
  1,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,1,
  1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
  1,0,1,0,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,
  1,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,
  1,1,1,1,1,0,1,0,0,3,0,0,1,0,1,1,1,1,1,
  0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,
  1,1,1,1,1,0,1,0,0,3,0,0,1,0,1,1,1,1,1,
  1,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,
  1,0,1,0,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,
  1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
  1,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,1,
  1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1,
  1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
  1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
  1,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,2,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 17 - The Octagon (Level 17)
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,1,1,1,2,1,1,1,0,0,0,0,0,1,
  1,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,1,
  1,0,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,0,1,
  1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
  1,0,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,0,1,
  1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,
  1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,1,
  1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
  1,2,1,0,0,0,0,0,0,3,0,0,0,0,0,0,1,2,1,
  1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
  1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,1,
  1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,
  1,0,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,0,1,
  1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
  1,0,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,0,1,
  1,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,1,
  1,0,0,0,0,0,1,1,1,2,1,1,1,0,0,0,0,0,1,
  1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 18 - Wave Pattern (Level 18)
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
  1,0,0,1,0,0,1,0,0,3,0,0,1,0,0,1,0,0,1,
  1,0,1,1,1,0,1,1,0,3,0,1,1,0,1,1,1,0,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
  1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,2,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],

// Map 19 - The Pyramid (FIXED - No traps)
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,2,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,2,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],

// Map 20 - Super Speed Arena (Level 20 - SUPER SPEED UNLOCKED!)
[
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,
  1,0,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,0,1,
  1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
  1,0,0,0,1,1,1,0,1,1,1,0,1,1,1,0,0,0,1,
  1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
  1,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,
  1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
  1,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,
  1,0,0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,0,1,
  1,0,1,1,1,1,1,0,1,3,1,0,1,1,1,1,1,0,1,
  1,0,1,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,1,
  1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,
  1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
  1,0,0,0,1,1,1,0,1,1,1,0,1,1,1,0,0,0,1,
  1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
  1,0,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],
// Map 21 - The Tunnels (Level 21)
[
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,
1,1,1,1,1,1,0,1,0,0,0,1,0,1,1,1,1,1,1,
1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,
1,2,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,2,1,
1,1,1,1,1,1,1,1,0,3,0,1,1,1,1,1,1,1,1,
1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,
1,1,1,1,1,1,0,1,0,0,0,1,0,1,1,1,1,1,1,
1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],
// Map 22 - Box Garden (Level 22)
[
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,
1,0,0,1,1,0,1,1,0,1,0,1,1,0,1,1,0,0,1,
1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
1,0,1,0,1,1,0,1,0,1,0,1,0,1,1,0,1,0,1,
1,0,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,0,1,
1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
1,0,1,1,0,1,1,0,1,1,1,0,1,1,0,1,1,0,1,
1,0,0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,0,1,
1,0,1,1,0,1,1,0,1,3,1,0,1,1,0,1,1,0,1,
1,0,1,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,1,
1,0,1,0,1,1,0,1,0,1,0,1,0,1,1,0,1,0,1,
1,0,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,0,1,
1,0,1,0,1,1,0,1,0,1,0,1,0,1,1,0,1,0,1,
1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
1,0,0,1,1,0,1,1,0,1,0,1,1,0,1,1,0,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],
// Map 23 - Corridor Madness (Level 23)
[
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,0,0,0,1,0,0,0,1,2,1,0,0,0,1,0,0,0,1,
1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,
1,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,
1,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,
1,0,1,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,1,
1,0,1,0,1,1,1,0,1,3,1,0,1,1,1,0,1,0,1,
1,0,1,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,1,
1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,
1,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,
1,0,1,0,1,0,1,0,1,2,1,0,1,0,1,0,1,0,1,
1,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],
// Map 24 - The Grid (Level 24)
[
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,2,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,2,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,0,1,1,1,0,1,0,1,1,1,0,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,0,1,0,1,0,3,0,1,0,1,0,1,0,1,1,
0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,
1,1,0,1,0,1,0,1,0,3,0,1,0,1,0,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,0,1,1,1,0,1,0,1,1,1,0,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,2,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,2,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],
// Map 25 - The Catacombs (FIXED - No traps)
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,2,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,2,1,
    1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,1,
    1,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,0,1,3,1,0,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,
    1,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,
    1,0,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,
    1,0,1,0,1,0,0,1,0,0,0,1,0,0,1,0,1,0,1,
    1,0,0,0,1,0,1,1,1,0,1,1,1,0,1,0,0,0,1,
    1,2,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,2,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],
// Map 26 - Windmill (FIXED - No traps)
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,
    1,0,1,0,1,1,0,1,0,1,0,1,0,1,1,0,1,0,1,
    1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,1,
    1,0,0,0,1,1,1,1,0,1,0,1,1,1,1,0,0,0,1,
    1,2,1,1,1,0,0,0,0,3,0,0,0,0,1,1,1,2,1,
    1,0,0,0,1,1,1,1,0,3,0,1,1,1,1,0,0,0,1,
    1,0,1,0,1,0,0,0,0,3,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,
    1,0,1,0,1,1,0,1,0,1,0,1,0,1,1,0,1,0,1,
    1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,
    1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],

// Map 27 - Star Burst (Level 27)
[
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,2,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,2,1,
1,0,0,1,1,1,1,0,1,0,1,0,1,1,1,1,0,0,1,
1,0,1,0,0,0,1,0,1,0,1,0,1,0,0,0,1,0,1,
1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,
1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,
1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,
1,1,1,1,1,0,1,0,1,1,1,0,1,0,1,1,1,1,1,
1,0,0,0,0,0,1,0,1,3,1,0,1,0,0,0,0,0,1,
1,1,1,1,1,0,1,0,1,3,1,0,1,0,1,1,1,1,1,
1,0,0,0,1,0,0,0,0,3,0,0,0,0,1,0,0,0,1,
1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,
1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,
1,0,1,0,0,0,1,0,1,0,1,0,1,0,0,0,1,0,1,
1,0,0,1,1,1,1,0,1,0,1,0,1,1,1,1,0,0,1,
1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,
1,2,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,2,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],
// Map 28 - The Gauntlet (Level 28)
[
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,
1,2,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,2,1,
1,1,0,1,1,1,1,1,1,3,1,1,1,1,1,1,0,1,1,
1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,2,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,2,1,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
],
// Map 29 - Circles (FIXED - No traps)
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,
    1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,
    1,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,
    1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,
    1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,
    1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,2,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,2,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ],

// Map 30 - BOSS BATTLE ARENA! (Epic Final Level)
  [
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1,
    1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
    1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,
    1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,
    1,2,0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,2,1,
    1,1,1,0,1,1,1,0,1,3,1,0,1,1,1,0,1,1,1,
    1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,
    1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,
    1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,
    1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,2,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,2,1,
    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
  ]
];


function generateMap(levelNum) {
  const templateIndex = (levelNum - 1) % mapTemplates.length;
  let map = [...mapTemplates[templateIndex]];
  
  // Only add random walls after going through all templates once
  const variation = Math.floor((levelNum - 1) / mapTemplates.length);
  if (variation > 0) {
    // Add some strategic walls but keep paths open
    for (let i = 0; i < map.length; i++) {
      if (map[i] === 0 && Math.random() < 0.03 * variation) {
        // Don't block edges or ghost home
        const row = Math.floor(i / GRID_WIDTH);
        const col = i % GRID_WIDTH;
        if (col > 1 && col < GRID_WIDTH - 2 && row > 1 && row < GRID_HEIGHT - 2 && 
            !(row >= 9 && row <= 11 && col >= 8 && col <= 10)) {
          map[i] = 1;
        }
      }
    }
  }
  
  return map;
}

let layout = [];
let cells = [];
let pacman = { index: 0, direction: 'right', nextDirection: 'right' };
let ghosts = [];
let dotsRemaining = 0;

highscoreEl.textContent = highscore;

function showSpecialFeature() {
  const features = {
    5: "üèÉ CORRIDOR CHASE! Long hallways, fast ghosts!",
    6: "üèöÔ∏è GHOST HOUSE! Beware the trap rooms!",
    7: "‚ö° LIGHTNING! Navigate the zigzag paths!",
    8: "ü™û MIRROR MAZE! Watch for your reflection!",
    9: "üëª 5TH GHOST! The Splitter joins the hunt!",
    10: "üçí FRUIT RING! Orbit the center for bonuses!",
    11: "üè¢ ELEVATOR SHAFTS! Vertical chaos ahead!",
    15: "üåü INVINCIBILITY! Power pellets last longer!",
    18: "üëæ GHOST SWARM! A 6th ghost appears!",
    20: "‚ö° SUPER SPEED ARENA! Power pellets give you super speed!",
    21: "üéØ PRECISION MODE! Smarter ghost AI!",
    24: "üî• MEGA BONUS! Triple points for everything!",
    27: "üèÜ CHAMPIONSHIP! Maximum difficulty!",
    30: "üéâ GHOST SWARM ARENA! Beat this to win!"
  };
  const feature = features[level];
  if (feature) {
    specialFeatureEl.setAttribute('data-text', feature);
    specialFeatureEl.textContent = feature;
    specialFeatureEl.style.display = 'block';
  } else {
    specialFeatureEl.style.display = 'none';
  }
}

function init() {
  layout = generateMap(level);
  cells = [];
  gameEl.innerHTML = '';
  
  showSpecialFeature();
  
  layout.forEach((val, i) => {
    const cell = document.createElement('div');
    cell.classList.add('cell');
    
    if (val === 1) {
  cell.classList.add('wall');
  if (level >= 24) cell.classList.add('mega');
  else if (level >= 12) cell.classList.add('bonus');
  else if (level >= 6) cell.classList.add('special');
}
    else if (val === 0) cell.classList.add('dot');
    else if (val === 2) cell.classList.add('power-pellet');
    
    gameEl.appendChild(cell);
    cells.push(cell);
  });
  
  dotsRemaining = layout.filter(v => v === 0 || v === 2).length;
  
  if (level >= 3) {
    const emptySpaces = layout.map((v, i) => v === 0 ? i : -1).filter(i => i !== -1);
    if (emptySpaces.length > 0) {
      const fruitIndex = emptySpaces[Math.floor(Math.random() * emptySpaces.length)];
      layout[fruitIndex] = 4;
      cells[fruitIndex].classList.remove('dot');
      cells[fruitIndex].classList.add('fruit');
      fruitPresent = true;
    }
  }
  
  pacman = {
    index: 19 * 17 + 9,
    direction: 'right',
    nextDirection: 'right',
    justAte: false
  };
  
  const baseSpeed = Math.max(300 - (level * 8), 80);
 const ghostCount = level >= 18 ? 6 : level >= 9 ? 5 : 4;
  const colors = ['red', 'pink', 'cyan', 'orange', 'purple', 'green'];
  
  ghosts = [];
  for (let i = 0; i < ghostCount; i++) {
    const startPositions = [19 * 9 + 9, 19 * 9 + 8, 19 * 9 + 10, 19 * 10 + 9, 19 * 9 + 7, 19 * 9 + 11];
    ghosts.push({
      index: startPositions[i],
      color: colors[i],
      direction: ['up', 'left', 'right', 'down', 'up', 'down'][i],
      speed: baseSpeed + (i * 30),
      scared: false,
      eaten: false
    });
  }
  
  updateLives();
  updateDisplay();
  // Initialize boss battle for level 30
  if (level === 30) {
    initBossBattle();
  }
  
  // Start power-up spawning
  startPowerUpSpawning();
  // Show dev mode selector if enabled
  if (DEV_MODE) {
    showDevModeSelector();
  } else {
    showReady();
  }
}

// Developer Mode Functions
function showDevModeSelector() {
  const existing = document.getElementById('dev-mode-selector');
  if (existing) existing.remove();
  
  const selector = document.createElement('div');
  selector.id = 'dev-mode-selector';
  selector.style.cssText = `
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(10, 10, 15, 0.98);
    padding: 30px;
    border: 3px solid #00ffff;
    border-radius: 20px;
    z-index: 999999;
    text-align: center;
    max-width: 90%;
    max-height: 80vh;
    overflow-y: auto;
  `;
  
  const header = document.createElement('h2');
  header.style.cssText = 'color: #00ffff; margin-bottom: 20px; font-family: Orbitron;';
  header.textContent = 'üîß DEV MODE';
  
  const description = document.createElement('p');
  description.style.cssText = 'color: #fff; margin-bottom: 20px;';
  description.textContent = 'Select a level to test (1-100):';
  
  const buttonGrid = document.createElement('div');
  buttonGrid.style.cssText = 'display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px; margin-bottom: 20px;';
  
  // Create level buttons
for (let i = 1; i <= 30; i++) {
    const btn = document.createElement('button');
    btn.textContent = i;
    btn.style.cssText = `
      padding: 10px;
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
    `;
    btn.onclick = () => jumpToLevel(i);
    buttonGrid.appendChild(btn);
  }
  
  const closeBtn = document.createElement('button');
  closeBtn.textContent = 'Close & Start Game';
  closeBtn.style.cssText = `
    padding: 15px 30px;
    background: linear-gradient(135deg, #ff0055, #ff8800);
    color: #fff;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    margin-top: 10px;
  `;
  closeBtn.onclick = closeDevMode;
  
  selector.appendChild(header);
  selector.appendChild(description);
  selector.appendChild(buttonGrid);
  selector.appendChild(closeBtn);
  
  document.body.appendChild(selector);
}
function jumpToLevel(targetLevel) {
  level = targetLevel;
  lives = 3;
  score = level * 1000; // Give some score for context
  const selector = document.getElementById('dev-mode-selector');
  if (selector) selector.remove();
  
  // Reinitialize the map but don't show dev selector again
  layout = generateMap(level);
  cells = [];
  gameEl.innerHTML = '';
  
  showSpecialFeature();
  
  layout.forEach((val, i) => {
    const cell = document.createElement('div');
    cell.classList.add('cell');
    
    if (val === 1) {
      cell.classList.add('wall');
      if (level >= 40) cell.classList.add('mega');
      else if (level >= 30) cell.classList.add('bonus');
      else if (level >= 20) cell.classList.add('special');
    }
    else if (val === 0) cell.classList.add('dot');
    else if (val === 2) cell.classList.add('power-pellet');
    
    gameEl.appendChild(cell);
    cells.push(cell);
  });
  
  dotsRemaining = layout.filter(v => v === 0 || v === 2).length;
  
  if (level >= 10) {
  const emptySpaces = layout.map((v, i) => v === 0 ? i : -1).filter(i => i !== -1);
  if (emptySpaces.length > 0) {
    const fruitIndex = emptySpaces[Math.floor(Math.random() * emptySpaces.length)];
    layout[fruitIndex] = 4;
    cells[fruitIndex].classList.remove('dot');
    cells[fruitIndex].classList.add('fruit');
    fruitPresent = true;
  }
}
  
  pacman = {
    index: 19 * 17 + 9,
    direction: 'right',
    nextDirection: 'right',
    justAte: false
  };
  
  const baseSpeed = Math.max(300 - (level * 8), 80);
  const ghostCount = level >= 60 ? 6 : level >= 30 ? 5 : 4;
  const colors = ['red', 'pink', 'cyan', 'orange', 'purple', 'green'];
  
  ghosts = [];
  for (let i = 0; i < ghostCount; i++) {
    const startPositions = [19 * 9 + 9, 19 * 9 + 8, 19 * 9 + 10, 19 * 10 + 9, 19 * 9 + 7, 19 * 9 + 11];
    ghosts.push({
      index: startPositions[i],
      color: colors[i],
      direction: ['up', 'left', 'right', 'down', 'up', 'down'][i],
      speed: baseSpeed + (i * 30),
      scared: false,
      eaten: false
    });
  }
  
  updateLives();
  updateDisplay();
  showReady();
}

function closeDevMode() {
  const selector = document.getElementById('dev-mode-selector');
  if (selector) selector.remove();
  level = 1; // Start from level 1
  lives = 3;
  score = 0;
  init(); // Reinitialize without dev mode
}

function showReady() {
  const ready = document.createElement('div');
  ready.id = 'ready-text';
  ready.textContent = level % 10 === 0 ? 'BONUS STAGE!' : 'READY!';
  gameContainer.appendChild(ready);
  
  playSound('levelComplete');
  
  setTimeout(() => {
    ready.remove();
    startGame();
  }, 2000);
}

function startGame() {
  gameActive = true;
  render();
  
  ghosts.forEach(ghost => {
    ghost.intervalId = setInterval(() => moveGhost(ghost), ghost.speed);
  });
}

function updateDisplay() {
  scoreEl.textContent = score;
  levelEl.textContent = level;
  
  if (score > highscore) {
    highscore = score;
    highscoreEl.textContent = highscore;
    localStorage.setItem('pacman-highscore', highscore);
  }
}

function updateLives() {
  livesEl.innerHTML = '';
  for (let i = 0; i < lives; i++) {
    const life = document.createElement('div');
    life.classList.add('life');
    livesEl.appendChild(life);
  }
}

function render() {
  cells.forEach((cell, index) => {
    cell.classList.remove('pacman', 'ghost', 'boss-ghost', 'red', 'pink', 'cyan', 'orange', 'purple', 'green', 'scared', 'eaten', 'right', 'left', 'up', 'down', 'eating', 'super');
    
    if (layout[index] === 3) {
      cell.classList.remove('dot', 'power-pellet', 'fruit', 'extra-life', 'shield', 'freeze', 'speed-boost', 'ghost-repel', 'double-points', 'confusion');
    }
  });
  
  const pacmanClasses = ['pacman', pacman.direction];
  if (superMode) pacmanClasses.push('super');
  if (shieldActive) {
    cells[pacman.index].style.boxShadow = '0 0 30px rgba(100, 200, 255, 1), 0 0 50px rgba(100, 200, 255, 0.8)';
  }
  if (gameActive) {
    pacmanClasses.push('eating');
  }
  cells[pacman.index].classList.add(...pacmanClasses);
  
  ghosts.forEach(ghost => {
    const classes = ghost.isBoss ? ['ghost', 'boss-ghost'] : ['ghost', ghost.color];
    if (ghost.scared) classes.push('scared');
    if (ghost.eaten) classes.push('eaten');
    cells[ghost.index].classList.add(...classes);
  });
}
function canMove(index, direction) {
let next = index;
if (direction === 'left') next -= 1;
else if (direction === 'right') next += 1;
else if (direction === 'up') next -= GRID_WIDTH;
else if (direction === 'down') next += GRID_WIDTH;
if (next < 0 || next >= layout.length) return false;
if (layout[next] === 1) return false;
const currentRow = Math.floor(index / GRID_WIDTH);
const nextRow = Math.floor(next / GRID_WIDTH);
if ((direction === 'left' || direction === 'right') && currentRow !== nextRow) {
return false;
}
return true;
}
function movePacman() {
  if (!gameActive) return;
  if (canMove(pacman.index, pacman.nextDirection)) {
    pacman.direction = pacman.nextDirection;
  }
  if (!canMove(pacman.index, pacman.direction)) {
    render();
    return;
  }
  
  let next = pacman.index;
  if (pacman.direction === 'left') next -= 1;
  else if (pacman.direction === 'right') next += 1;
  else if (pacman.direction === 'up') next -= GRID_WIDTH;
  else if (pacman.direction === 'down') next += GRID_WIDTH;
  pacman.index = next;
  
  const pointMultiplier = (level >= 24 ? 3 : level >= 12 ? 2 : 1) * (doublePointsActive ? 2 : 1);
  
  // Handle regular dots
  if (layout[pacman.index] === 0) {
    layout[pacman.index] = 3;
    const basePoints = 10 * level * pointMultiplier;
    if (pacman.justAte && superMode) {
      score += basePoints * 1.5;
    } else {
      score += basePoints;
    }
    dotsRemaining--;
    pacman.justAte = true;
    updateDisplay();
    playSound('chomp');
  }
  // Handle power pellets
  else if (layout[pacman.index] === 2) {
    layout[pacman.index] = 3;
    score += 50 * level * pointMultiplier;
    dotsRemaining--;
    pacman.justAte = true;
    updateDisplay();
    playSound('powerPellet');
    activatePowerMode();
  }
  // Handle fruit
  else if (layout[pacman.index] === 4) {
    layout[pacman.index] = 3;
    score += 500 * level * pointMultiplier;
    pacman.justAte = true;
    fruitPresent = false;
    updateDisplay();
    playSound('fruit');
  }
  // Handle EXTRA LIFE
  else if (layout[pacman.index] === POWER_UPS.EXTRA_LIFE) {
    layout[pacman.index] = 3;
    lives++;
    updateLives();
    score += 1000 * level * pointMultiplier;
    updateDisplay();
    playSound('fruit');
    showTempMessage('‚ù§Ô∏è EXTRA LIFE! ‚ù§Ô∏è', '#ff0066');
  }
  // Handle SHIELD
  else if (layout[pacman.index] === POWER_UPS.SHIELD) {
    layout[pacman.index] = 3;
    activateShield();
    score += 200 * level * pointMultiplier;
    updateDisplay();
    playSound('powerPellet');
  }
  // Handle FREEZE
  else if (layout[pacman.index] === POWER_UPS.FREEZE) {
    layout[pacman.index] = 3;
    activateFreeze();
    score += 300 * level * pointMultiplier;
    updateDisplay();
    playSound('powerPellet');
  }
  // Handle SPEED BOOST
  else if (layout[pacman.index] === POWER_UPS.SPEED_BOOST) {
    layout[pacman.index] = 3;
    activateSpeedBoost();
    score += 150 * level * pointMultiplier;
    updateDisplay();
    playSound('powerPellet');
  }
  // Handle GHOST REPEL
  else if (layout[pacman.index] === POWER_UPS.GHOST_REPEL) {
    layout[pacman.index] = 3;
    repelGhosts();
    score += 250 * level * pointMultiplier;
    updateDisplay();
    playSound('eatGhost');
  }
  // Handle DOUBLE POINTS
  else if (layout[pacman.index] === POWER_UPS.DOUBLE_POINTS) {
    layout[pacman.index] = 3;
    activateDoublePoints();
    score += 100 * level * pointMultiplier;
    updateDisplay();
    playSound('fruit');
  }
  // Handle CONFUSION (power-down)
  else if (layout[pacman.index] === POWER_UPS.CONFUSION) {
    layout[pacman.index] = 3;
    activateConfusion();
    score += 50 * level * pointMultiplier;
    updateDisplay();
    playSound('death');
  }
  
  // Handle boss collision for level 30
  if (level === 30 && !bossDefeated) {
    checkBossCollision();
  } else {
    checkGhostCollision();
  }
  
  if (dotsRemaining === 0) {
    levelComplete();
  }
  render();
}
// Power-up spawn system
function spawnRandomPowerUp() {
  if (!gameActive || level < 3) return;
  
  const emptySpaces = layout.map((v, i) => v === 0 ? i : -1).filter(i => i !== -1);
  if (emptySpaces.length === 0) return;
  
  const powerUpIndex = emptySpaces[Math.floor(Math.random() * emptySpaces.length)];
  
  let powerUpType;
  const rand = Math.random();
  
  if (level >= 5 && rand < 0.15) {
    powerUpType = POWER_UPS.EXTRA_LIFE;
  } else if (level >= 8 && rand < 0.25) {
    powerUpType = POWER_UPS.SHIELD;
  } else if (level >= 10 && rand < 0.35) {
    powerUpType = POWER_UPS.FREEZE;
  } else if (level >= 12 && rand < 0.45) {
    powerUpType = POWER_UPS.SPEED_BOOST;
  } else if (level >= 15 && rand < 0.55) {
    powerUpType = POWER_UPS.GHOST_REPEL;
  } else if (level >= 18 && rand < 0.70) {
    powerUpType = POWER_UPS.DOUBLE_POINTS;
  } else if (level >= 20 && rand < 0.85) {
    powerUpType = POWER_UPS.CONFUSION;
  } else {
    return;
  }
  
  layout[powerUpIndex] = powerUpType;
  cells[powerUpIndex].classList.remove('dot');
  
  const classMap = {
    [POWER_UPS.EXTRA_LIFE]: 'extra-life',
    [POWER_UPS.SHIELD]: 'shield',
    [POWER_UPS.FREEZE]: 'freeze',
    [POWER_UPS.SPEED_BOOST]: 'speed-boost',
    [POWER_UPS.GHOST_REPEL]: 'ghost-repel',
    [POWER_UPS.DOUBLE_POINTS]: 'double-points',
    [POWER_UPS.CONFUSION]: 'confusion'
  };
  
  cells[powerUpIndex].classList.add(classMap[powerUpType]);
  
  if (Math.random() < 0.4 && powerUpType !== POWER_UPS.CONFUSION) {
    setTimeout(() => {
      if (layout[powerUpIndex] === powerUpType) {
        layout[powerUpIndex] = 3;
        cells[powerUpIndex].classList.remove(classMap[powerUpType]);
      }
    }, 5000 + Math.random() * 5000);
  }
}

function activateShield() {
  shieldActive = true;
  showTempMessage('üõ°Ô∏è SHIELD ACTIVE!', '#64c8ff');
  gameContainer.style.boxShadow = '0 0 60px rgba(100, 200, 255, 0.8), inset 0 0 60px rgba(100, 200, 255, 0.3)';
  
  setTimeout(() => {
    shieldActive = false;
    gameContainer.style.boxShadow = '';
    showTempMessage('Shield Expired', '#888');
  }, 8000);
}

function activateFreeze() {
  freezeActive = true;
  showTempMessage('‚ùÑÔ∏è GHOSTS FROZEN!', '#96dcff');
  
  setTimeout(() => {
    freezeActive = false;
    showTempMessage('Freeze Expired', '#888');
  }, 5000);
}

function activateSpeedBoost() {
  speedBoostActive = true;
  showTempMessage('‚ö° SPEED BOOST!', '#ffff00');
  startGameLoop();
  
  setTimeout(() => {
    speedBoostActive = false;
    startGameLoop();
    showTempMessage('Speed Boost Expired', '#888');
  }, 7000);
}

function repelGhosts() {
  showTempMessage('üåü GHOSTS REPELLED!', '#ffd700');
  ghosts.forEach(ghost => {
    const dx = ghost.index % GRID_WIDTH - pacman.index % GRID_WIDTH;
    const dy = Math.floor(ghost.index / GRID_WIDTH) - Math.floor(pacman.index / GRID_WIDTH);
    
    for (let i = 0; i < 5; i++) {
      let newIndex = ghost.index;
      if (Math.abs(dx) > Math.abs(dy)) {
        if (dx > 0 && canMove(ghost.index, 'right')) newIndex += 1;
        else if (dx < 0 && canMove(ghost.index, 'left')) newIndex -= 1;
      } else {
        if (dy > 0 && canMove(ghost.index, 'down')) newIndex += GRID_WIDTH;
        else if (dy < 0 && canMove(ghost.index, 'up')) newIndex -= GRID_WIDTH;
      }
      ghost.index = newIndex;
    }
  });
}

function activateDoublePoints() {
  doublePointsActive = true;
  showTempMessage('üí∞ DOUBLE POINTS!', '#ffd700');
  
  setTimeout(() => {
    doublePointsActive = false;
    showTempMessage('Double Points Expired', '#888');
  }, 15000);
}

function activateConfusion() {
  confusionActive = true;
  showTempMessage('üåÄ YOU ARE CONFUSED!', '#8a2be2');
  
  setTimeout(() => {
    confusionActive = false;
    showTempMessage('Confusion Cleared', '#888');
  }, 6000);
}

function showTempMessage(text, color) {
  const msg = document.createElement('div');
  msg.style.cssText = `
    position: fixed;
    top: 35%;
    left: 50%;
    transform: translateX(-50%);
    background: ${color};
    color: #fff;
    padding: 15px 30px;
    border-radius: 15px;
    font-family: 'Orbitron', sans-serif;
    font-size: 1.3em;
    font-weight: bold;
    z-index: 999;
    animation: temp-message 0.5s ease-out;
    box-shadow: 0 0 30px ${color};
  `;
  msg.textContent = text;
  document.body.appendChild(msg);
  
  setTimeout(() => {
    msg.style.opacity = '0';
    msg.style.transform = 'translateX(-50%) translateY(-20px)';
    setTimeout(() => msg.remove(), 500);
  }, 2000);
}

function startPowerUpSpawning() {
  if (powerUpSpawnInterval) clearInterval(powerUpSpawnInterval);
  
  powerUpSpawnInterval = setInterval(() => {
    if (gameActive && Math.random() < 0.3) {
      spawnRandomPowerUp();
    }
  }, 8000);
}

function initBossBattle() {
  bossHealth = 100;
  bossPhase = 1;
  bossDefeated = false;
  bossMessages = [
    "HAHA! YOU CAN'T BEAT ME!",
    "I'M GONNA CATCH YOU!",
    "YOU'RE TOO SLOW!",
    "GAME OVER FOR YOU!",
    "NICE TRY, LOSER!",
    "IS THAT ALL YOU GOT?",
    "I'M UNBEATABLE!",
    "YOU'LL NEVER WIN!",
    "GIVE UP NOW!",
    "TOO EASY!"
  ];
  
  const healthBarContainer = document.createElement('div');
  healthBarContainer.classList.add('boss-healthbar');
  healthBarContainer.innerHTML = '<div class="boss-healthbar-fill" id="boss-health-fill" style="width: 100%;"></div>';
  document.body.appendChild(healthBarContainer);
  
  ghosts[0].isBoss = true;
  
  setInterval(() => {
    if (gameActive && level === 30 && !bossDefeated && Math.random() < 0.2) {
      showBossMessage(bossMessages[Math.floor(Math.random() * bossMessages.length)]);
    }
  }, 5000);
}

function showBossMessage(message) {
  const msg = document.createElement('div');
  msg.classList.add('boss-message');
  msg.textContent = message;
  document.body.appendChild(msg);
  
  setTimeout(() => {
    msg.style.opacity = '0';
    setTimeout(() => msg.remove(), 500);
  }, 2500);
}

function checkBossCollision() {
  const boss = ghosts[0];
  
  if (boss.index === pacman.index && !boss.eaten) {
    if (powerMode || shieldActive) {
      bossHealth -= 20;
      boss.eaten = true;
      boss.scared = false;
      
      const healthFill = document.getElementById('boss-health-fill');
      if (healthFill) {
        healthFill.style.width = bossHealth + '%';
      }
      
      score += 1000 * level;
      updateDisplay();
      playSound('eatGhost');
      
      if (bossHealth <= 0) {
        defeatBoss();
      } else {
        if (bossHealth <= 50 && bossPhase === 1) {
          bossPhase = 2;
          showBossMessage("ARGH! YOU'LL PAY FOR THAT!");
          boss.speed = Math.max(boss.speed - 50, 50);
        } else if (bossHealth <= 25 && bossPhase === 2) {
          bossPhase = 3;
          showBossMessage("IMPOSSIBLE! THIS CAN'T BE!");
          boss.speed = Math.max(boss.speed - 50, 30);
        }
        
        setTimeout(() => {
          boss.eaten = false;
          boss.index = 19 * 9 + 9;
        }, 3000);
      }
    } else if (!shieldActive) {
      die();
    }
  }
  
  for (let i = 1; i < ghosts.length; i++) {
    if (ghosts[i].index === pacman.index && !ghosts[i].eaten) {
      if (ghosts[i].scared) {
        ghosts[i].eaten = true;
        ghosts[i].scared = false;
        score += 200 * level;
        updateDisplay();
        playSound('eatGhost');
        setTimeout(() => {
          ghosts[i].eaten = false;
          ghosts[i].index = 19 * 9 + 9;
        }, 5000);
      } else if (!shieldActive) {
        die();
      }
    }
  }
}

function defeatBoss() {
  bossDefeated = true;
  gameActive = false;
  showBossMessage("NOOOO! I'VE BEEN DEFEATED!");
  
  setTimeout(() => {
    const healthBar = document.querySelector('.boss-healthbar');
    if (healthBar) healthBar.remove();
    
    playSound('levelComplete');
    const msg = document.createElement('div');
    msg.classList.add('message');
    msg.innerHTML = `
      <h2>üéâ BOSS DEFEATED! üéâ</h2>
      <p>üíÄ The Ghost King has fallen! üíÄ</p>
      <p>Bonus: ${5000 * level} points</p>
      <p style="color:#ffd700; margin-top:15px;">Congratulations on conquering all 30 levels!</p>
    `;
    gameContainer.appendChild(msg);
    
    score += 5000 * level;
    updateDisplay();
    
    setTimeout(() => {
      msg.remove();
      youWin();
    }, 5000);
  }, 2000);
}

function activatePowerMode() {
powerMode = true;
superMode = level >= 6;
ghosts.forEach(g => {
if (!g.eaten) g.scared = true;
});

// Visual feedback for super speed
if (superMode) {
gameContainer.style.boxShadow = '0 0 60px rgba(0, 255, 255, 0.8), inset 0 0 60px rgba(0, 255, 255, 0.3)';
setTimeout(() => {
gameContainer.style.boxShadow = '';
}, 300);
}
if (powerModeTimer) clearTimeout(powerModeTimer);
const duration = level >= 15 ? 10000 : Math.max(7000 - (level * 120), 3000);
powerModeTimer = setTimeout(() => {
powerMode = false;
superMode = false;
ghosts.forEach(g => g.scared = false);
render();
}, duration);
}
function moveGhost(ghost) {
  if (!gameActive || ghost.eaten || (freezeActive && !ghost.isBoss)) return;
  
  if (freezeActive && ghost.isBoss) {
    if (Math.random() < 0.5) return;
  }
  
  const possibleDirections = ['left', 'right', 'up', 'down'].filter(dir => {
    const opposite = {left: 'right', right: 'left', up: 'down', down: 'up'};
    return dir !== opposite[ghost.direction] && canMove(ghost.index, dir);
  });
  
  if (possibleDirections.length === 0) {
    possibleDirections.push(...['left', 'right', 'up', 'down'].filter(dir => canMove(ghost.index, dir)));
  }
  
  if (possibleDirections.length > 0) {
    if (confusionActive || ghost.scared) {
      ghost.direction = possibleDirections[Math.floor(Math.random() * possibleDirections.length)];
    } else {
      const smartChance = (level >= 21 ? 0.7 : 0.3) + (ghost.isBoss ? 0.2 : 0);
      if (Math.random() > smartChance) {
        const distances = possibleDirections.map(dir => {
          let next = ghost.index;
          if (dir === 'left') next -= 1;
          else if (dir === 'right') next += 1;
          else if (dir === 'up') next -= GRID_WIDTH;
          else if (dir === 'down') next += GRID_WIDTH;
          
          const dx = (next % GRID_WIDTH) - (pacman.index % GRID_WIDTH);
          const dy = Math.floor(next / GRID_WIDTH) - Math.floor(pacman.index / GRID_WIDTH);
          return { dir, dist: Math.abs(dx) + Math.abs(dy) };
        });
        
        distances.sort((a, b) => a.dist - b.dist);
        ghost.direction = distances[0].dir;
      } else {
        ghost.direction = possibleDirections[Math.floor(Math.random() * possibleDirections.length)];
      }
    }
  }
  
  if (canMove(ghost.index, ghost.direction)) {
    let next = ghost.index;
    if (ghost.direction === 'left') next -= 1;
    else if (ghost.direction === 'right') next += 1;
    else if (ghost.direction === 'up') next -= GRID_WIDTH;
    else if (ghost.direction === 'down') next += GRID_WIDTH;
    ghost.index = next;
  }
  
  if (level === 30 && !bossDefeated) {
    checkBossCollision();
  } else {
    checkGhostCollision();
  }
  render();
}
function checkGhostCollision() {
ghosts.forEach(ghost => {
if (ghost.index === pacman.index && !ghost.eaten) {
if (ghost.scared) {
ghost.eaten = true;
ghost.scared = false;
const pointMultiplier = level >= 80 ? 3 : level >= 40 ? 2 : 1;
score += 200 * level * pointMultiplier;
updateDisplay();
playSound('eatGhost');
    setTimeout(() => {
      ghost.eaten = false;
      ghost.index = 19 * 9 + 9;
    }, 5000);
  } else {
    die();
  }
}
});
}
function die() {
gameActive = false;
lives--;
updateLives();
playSound('death');
ghosts.forEach(g => {
clearInterval(g.intervalId);
});
if (powerModeTimer) clearTimeout(powerModeTimer);
powerMode = false;
superMode = false;
if (lives > 0) {
setTimeout(() => {
pacman.index = 19 * 17 + 9;
pacman.direction = 'right';
pacman.nextDirection = 'right';
pacman.justAte = false;
  const startPositions = [19 * 9 + 9, 19 * 9 + 8, 19 * 9 + 10, 19 * 10 + 9, 19 * 9 + 7, 19 * 9 + 11];
  ghosts.forEach((g, i) => {
    g.index = startPositions[i];
    g.scared = false;
    g.eaten = false;
  });
  
  showReady();
}, 1500);
} else {
gameOver();
}
}
function levelComplete() {
gameActive = false;
ghosts.forEach(g => clearInterval(g.intervalId));
if (powerModeTimer) clearTimeout(powerModeTimer);
const bonus = 1000 * level;
score += bonus;
updateDisplay();
playSound('levelComplete');
const msg = document.createElement('div');
msg.classList.add('message');
msg.innerHTML = `
  <h2>LEVEL ${level} COMPLETE!</h2>
  <p>Bonus: ${bonus} points</p>
  <p>Get ready for Level ${level + 1}...</p>
  ${[2, 5, 8, 11, 14, 17, 20, 23, 26, 29].includes(level) ? '<p style="color:#ff00ff;">‚≠ê NEW FEATURE UNLOCKED NEXT LEVEL! ‚≠ê</p>' : ''}
`;
gameContainer.appendChild(msg);
setTimeout(() => {
msg.remove();
level++;
if (level <= 30) {
init();
} else {
youWin();
}
}, 3000);
}
function gameOver() {
const msg = document.createElement('div');
msg.classList.add('message');
msg.innerHTML = `
  <h2>GAME OVER</h2>
  <p>Final Score: ${score}</p>
  <p>Level Reached: ${level}</p>
  <p>High Score: ${highscore}</p>
  <button onclick="restart()">PLAY AGAIN</button>
`;
gameContainer.appendChild(msg);
}
function youWin() {
playSound('levelComplete');
const msg = document.createElement('div');
msg.classList.add('message');
msg.innerHTML = `
  <h2>üéâ VICTORY! üéâ</h2>
  <p>üèÜ You conquered all 30 levels! üèÜ</p>
  <p>Final Score: ${score}</p>
  <p>High Score: ${highscore}</p>
  <p style="color:#00ffff; margin-top:15px;">You are a PAC-MAN MASTER!</p>
  <button onclick="restart()">PLAY AGAIN</button>
`;
gameContainer.appendChild(msg);
}
function restart() {
score = 0;
level = 1;
lives = 3;
gameActive = false;
powerMode = false;
superMode = false;
fruitPresent = false;
document.querySelectorAll('.message').forEach(m => m.remove());
ghosts.forEach(g => {
if (g.intervalId) clearInterval(g.intervalId);
});
if (powerModeTimer) clearTimeout(powerModeTimer);
init();
}
function handleControl(direction) {
if (!gameActive) return;
pacman.nextDirection = direction;
}
// Keyboard controls
window.addEventListener('keydown', (e) => {
if (['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', ' '].includes(e.key)) {
e.preventDefault();
}
if (!gameActive) return;
const key = e.key;
if (key === 'ArrowLeft' || key === 'a' || key === 'A') {
pacman.nextDirection = 'left';
} else if (key === 'ArrowRight' || key === 'd' || key === 'D') {
pacman.nextDirection = 'right';
} else if (key === 'ArrowUp' || key === 'w' || key === 'W') {
pacman.nextDirection = 'up';
} else if (key === 'ArrowDown' || key === 's' || key === 'S') {
pacman.nextDirection = 'down';
}
});
// Button controls
document.getElementById('btn-up').addEventListener('click', () => handleControl('up'));
document.getElementById('btn-down').addEventListener('click', () => handleControl('down'));
document.getElementById('btn-left').addEventListener('click', () => handleControl('left'));
document.getElementById('btn-right').addEventListener('click', () => handleControl('right'));
// Touch/Swipe controls
let touchStartX = 0;
let touchStartY = 0;
let touchEndX = 0;
let touchEndY = 0;
const minSwipeDistance = 30;
gameContainer.addEventListener('touchstart', (e) => {
touchStartX = e.changedTouches[0].screenX;
touchStartY = e.changedTouches[0].screenY;
}, {passive: true});
gameContainer.addEventListener('touchend', (e) => {
if (!gameActive) return;
touchEndX = e.changedTouches[0].screenX;
touchEndY = e.changedTouches[0].screenY;
handleSwipe();
}, {passive: true});
function handleSwipe() {
const diffX = touchEndX - touchStartX;
const diffY = touchEndY - touchStartY;
if (Math.abs(diffX) < minSwipeDistance && Math.abs(diffY) < minSwipeDistance) {
return;
}
if (Math.abs(diffX) > Math.abs(diffY)) {
if (diffX > 0) {
pacman.nextDirection = 'right';
} else {
pacman.nextDirection = 'left';
}
} else {
if (diffY > 0) {
pacman.nextDirection = 'down';
} else {
pacman.nextDirection = 'up';
}
}
}
// Game loop - FIXED
let gameLoop;
function startGameLoop() {
  if (gameLoop) clearInterval(gameLoop);
  let speed = superMode ? 80 : 150;
  if (speedBoostActive) speed = speed * 0.6;
  
  gameLoop = setInterval(() => {
    if (gameActive) movePacman();
  }, speed);
}
startGameLoop();

// Watch for super mode changes and restart loop
let lastSuperMode = false;
setInterval(() => {
if (gameActive && superMode !== lastSuperMode) {
lastSuperMode = superMode;
startGameLoop();
}
}, 50);
// Prevent page scroll on mobile
document.body.addEventListener('touchmove', (e) => {
if (e.target.closest('#game-container') || e.target.closest('.button-controls')) {
e.preventDefault();
}
}, {passive: false});
// Create snowflakes
function createSnowflakes() {
const snowflakeCount = 15;
for (let i = 0; i < snowflakeCount; i++) {
const snowflake = document.createElement('div');
snowflake.classList.add('snowflake');
snowflake.textContent = '‚ùÑ';
snowflake.style.left = Math.random() * 100 + '%';
snowflake.style.animationDelay = Math.random() * 10 + 's';
snowflake.style.animationDuration = (Math.random() * 5 + 8) + 's';
snowflake.style.fontSize = (Math.random() * 0.5 + 0.5) + 'em';
snowflake.style.opacity = Math.random() * 0.6 + 0.4;
document.body.appendChild(snowflake);
}
}
createSnowflakes();
// Initialize game
init();
// JS ENDS
// JS ENDS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS ENDS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS ENDS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS ENDS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS ends JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
// JS STARTS JS JS JS JS JS JSJS JS JS JS JS JS JS JS JS JS JS JS JS JS JS
</script>
</body>
</html>